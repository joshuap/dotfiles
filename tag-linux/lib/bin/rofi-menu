#!/usr/bin/env bash

declare -A OPTIONS

OPTIONS['contacts']="~/.lib/bin/rofi-contacts"
OPTIONS['browser']="google-chrome-stable"

if [ -z "$(pgrep rofi)" ]; then
  MODE="bin"
else
  MODE="modi"
fi

function print_menu()
{
  for key in ${!OPTIONS[@]}; do
    echo "$key"
  done
}

option="${1}"

if [ $MODE = "bin" ] && test -z ${option}; then
  option="$(print_menu | rofi -dmenu -p "app")"

  if test -z ${option}; then
    exit
  fi
fi

if [ $MODE = "modi" ] && test -z ${option}; then
  print_menu
  exit
fi

if test ${OPTIONS[$option]+isset}; then
  eval "${OPTIONS[$option]}" > /dev/null 2>&1 &
else
  xdg-open https://duckduckgo.com/?q=$(echo "$option" | sed 's/[[:space:]]/+/g') > /dev/null 2>&1 &
fi
